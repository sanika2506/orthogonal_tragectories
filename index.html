<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Orthogonal Trajectory Calculator</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.2);
            overflow: hidden;
        }
        
        header {
            background: linear-gradient(135deg, #4A00E0 0%, #8E2DE2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        h1 {
            font-size: 2.2rem;
            margin-bottom: 10px;
        }
        
        .subtitle {
            font-size: 1.1rem;
            opacity: 0.9;
        }
        
        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            padding: 30px;
        }
        
        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
            }
        }
        
        .input-section {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 10px;
        }
        
        .graph-section {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 10px;
        }
        
        .section-title {
            color: #4A00E0;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #e0e0e0;
            font-size: 1.3rem;
        }
        
        .input-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #555;
        }
        
        input, select {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            transition: all 0.3s;
        }
        
        input:focus, select:focus {
            outline: none;
            border-color: #4A00E0;
            box-shadow: 0 0 0 3px rgba(74, 0, 224, 0.1);
        }
        
        .quick-examples {
            margin-top: 25px;
        }
        
        .examples-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-top: 10px;
        }
        
        .example-btn {
            padding: 12px;
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            cursor: pointer;
            text-align: center;
            transition: all 0.3s;
            font-size: 14px;
        }
        
        .example-btn:hover {
            border-color: #4A00E0;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .calculate-btn {
            background: linear-gradient(135deg, #4A00E0 0%, #8E2DE2 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            width: 100%;
            margin-top: 20px;
            transition: all 0.3s;
        }
        
        .calculate-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 7px 20px rgba(74, 0, 224, 0.3);
        }
        
        .graph-container {
            height: 300px;
            position: relative;
            background: white;
            border-radius: 8px;
            border: 1px solid #e0e0e0;
        }
        
        .results {
            background: #f8f9fa;
            padding: 30px;
            margin-top: 20px;
            border-radius: 10px;
        }
        
        .results-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin-top: 20px;
        }
        
        @media (max-width: 768px) {
            .results-grid {
                grid-template-columns: 1fr;
            }
        }
        
        .result-box {
            background: white;
            padding: 20px;
            border-radius: 8px;
            border-left: 4px solid #4A00E0;
        }
        
        .result-title {
            color: #4A00E0;
            font-weight: 600;
            margin-bottom: 10px;
            font-size: 1.1rem;
        }
        
        .result-content {
            font-family: 'Courier New', monospace;
            font-size: 1rem;
            color: #333;
            line-height: 1.5;
        }
        
        .legend {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 15px;
            flex-wrap: wrap;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.9rem;
        }
        
        .legend-color {
            width: 20px;
            height: 10px;
            border-radius: 2px;
        }
        
        .info-box {
            background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
            padding: 15px;
            border-radius: 8px;
            margin-top: 20px;
            border-left: 4px solid #2196f3;
        }
        
        .footer {
            text-align: center;
            padding: 20px;
            color: #666;
            font-size: 0.9rem;
            background: #f8f9fa;
            border-top: 1px solid #e0e0e0;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Orthogonal Trajectory Calculator</h1>
            <p class="subtitle">Find curves that intersect at 90° angles. Enter any curve equation!</p>
        </header>
        
        <div class="main-content">
            <div class="input-section">
                <h2 class="section-title">Enter Your Curve</h2>
                
                <div class="input-group">
                    <label for="equation">Curve Equation:</label>
                    <input type="text" id="equation" placeholder="Example: y = x^2 or x^2 + y^2 = 9" value="y = x^2">
                </div>
                
                <div class="quick-examples">
                    <label>Quick Examples (click to try):</label>
                    <div class="examples-grid">
                        <button class="example-btn" data-eq="y = x^2">Parabola: y = x²</button>
                        <button class="example-btn" data-eq="x^2 + y^2 = 25">Circle: x² + y² = 25</button>
                        <button class="example-btn" data-eq="y = 1/x">Hyperbola: y = 1/x</button>
                        <button class="example-btn" data-eq="y = sin(x)">Sine: y = sin(x)</button>
                        <button class="example-btn" data-eq="y = e^x">Exponential: y = eˣ</button>
                        <button class="example-btn" data-eq="y = x^3">Cubic: y = x³</button>
                    </div>
                </div>
                
                <button class="calculate-btn" id="calculateBtn">
                    Calculate Orthogonal Trajectory
                </button>
                
                <div class="info-box">
                    <p><strong>How it works:</strong> For a curve y = f(x), the orthogonal trajectory satisfies dy/dx = -1/f'(x). We solve this differential equation to find the orthogonal family.</p>
                </div>
            </div>
            
            <div class="graph-section">
                <h2 class="section-title">Visualization</h2>
                <div class="graph-container">
                    <canvas id="trajectoryChart"></canvas>
                </div>
                
                <div class="legend">
                    <div class="legend-item">
                        <div class="legend-color" style="background-color: #4A00E0;"></div>
                        <span>Original Curve</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background-color: #FF5722;"></div>
                        <span>Orthogonal Trajectories</span>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="results">
            <h2 class="section-title">Results</h2>
            <div class="results-grid">
                <div class="result-box">
                    <div class="result-title">Original Curve:</div>
                    <div class="result-content" id="originalCurve">y = x²</div>
                </div>
                
                <div class="result-box">
                    <div class="result-title">Orthogonal Trajectory:</div>
                    <div class="result-content" id="orthogonalCurve">y = -½ ln|x| + C</div>
                </div>
                
                <div class="result-box">
                    <div class="result-title">Mathematical Steps:</div>
                    <div class="result-content" id="calculationSteps">
                        1. y = x²<br>
                        2. dy/dx = 2x<br>
                        3. Orthogonal slope = -1/(2x)<br>
                        4. Solve: dy/dx = -1/(2x)<br>
                        5. Solution: y = -½ ln|x| + C
                    </div>
                </div>
                
                <div class="result-box">
                    <div class="result-title">Explanation:</div>
                    <div class="result-content">
                        The orthogonal trajectories intersect the original curve at right angles (90°). Each trajectory corresponds to a different value of the constant C.
                    </div>
                </div>
            </div>
        </div>
        
        <div class="footer">
            <p>Orthogonal Trajectory Calculator | Works with any curve equation | Click "Calculate" to see results</p>
        </div>
    </div>

    <script>
        // DOM Elements
        const equationInput = document.getElementById('equation');
        const calculateBtn = document.getElementById('calculateBtn');
        const exampleBtns = document.querySelectorAll('.example-btn');
        const originalCurve = document.getElementById('originalCurve');
        const orthogonalCurve = document.getElementById('orthogonalCurve');
        const calculationSteps = document.getElementById('calculationSteps');
        
        // Initialize Chart.js
        const ctx = document.getElementById('trajectoryChart').getContext('2d');
        let trajectoryChart;
        
        // Set up example buttons
        exampleBtns.forEach(btn => {
            btn.addEventListener('click', function() {
                equationInput.value = this.dataset.eq;
                calculateOrthogonal();
            });
        });
        
        // Calculate button event
        calculateBtn.addEventListener('click', calculateOrthogonal);
        
        // Enter key support
        equationInput.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                calculateOrthogonal();
            }
        });
        
        // Initialize chart
        function initializeChart() {
            if (trajectoryChart) {
                trajectoryChart.destroy();
            }
            
            trajectoryChart = new Chart(ctx, {
                type: 'scatter',
                data: {
                    datasets: [
                        {
                            label: 'Original Curve',
                            data: [],
                            backgroundColor: '#4A00E0',
                            borderColor: '#4A00E0',
                            pointRadius: 0,
                            borderWidth: 3,
                            showLine: true,
                            fill: false,
                            tension: 0
                        },
                        {
                            label: 'Orthogonal Trajectories',
                            data: [],
                            backgroundColor: '#FF5722',
                            borderColor: '#FF5722',
                            pointRadius: 0,
                            borderWidth: 2,
                            showLine: true,
                            fill: false,
                            tension: 0
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: {
                            type: 'linear',
                            position: 'bottom',
                            title: {
                                display: true,
                                text: 'x-axis',
                                font: { size: 12, weight: 'bold' }
                            },
                            grid: { color: 'rgba(0,0,0,0.1)' },
                            min: -10,
                            max: 10
                        },
                        y: {
                            title: {
                                display: true,
                                text: 'y-axis',
                                font: { size: 12, weight: 'bold' }
                            },
                            grid: { color: 'rgba(0,0,0,0.1)' },
                            min: -10,
                            max: 10
                        }
                    },
                    plugins: {
                        legend: { display: false },
                        tooltip: { enabled: false }
                    }
                }
            });
        }
        
        // Main calculation function
        function calculateOrthogonal() {
            const equation = equationInput.value.trim();
            
            if (!equation) {
                alert('Please enter a curve equation.');
                return;
            }
            
            // Parse the equation
            const parsed = parseEquation(equation);
            
            if (!parsed.success) {
                alert('Please enter a valid equation. Examples:\n- y = x^2\n- x^2 + y^2 = 25\n- y = sin(x)\n- y = 1/x');
                return;
            }
            
            // Calculate orthogonal trajectory
            const result = calculateTrajectory(parsed);
            
            // Update display
            originalCurve.textContent = parsed.display;
            orthogonalCurve.textContent = result.equation;
            calculationSteps.innerHTML = result.steps.join('<br>');
            
            // Update chart
            updateChart(parsed, result);
        }
        
        // Parse equation function
        function parseEquation(eq) {
            eq = eq.replace(/\s+/g, '');
            
            // Check for y = f(x) format
            if (eq.toLowerCase().startsWith('y=')) {
                const f = eq.substring(2);
                return {
                    success: true,
                    type: 'explicit',
                    f: f,
                    display: `y = ${formatEquation(f)}`
                };
            }
            
            // Check for x^2 + y^2 = constant
            const circleMatch = eq.match(/x\^2\+y\^2=(\d+)/);
            if (circleMatch) {
                const r = Math.sqrt(parseInt(circleMatch[1]));
                return {
                    success: true,
                    type: 'circle',
                    r: r,
                    display: `x² + y² = ${r}²`
                };
            }
            
            // Check for implicit equation
            if (eq.includes('=')) {
                const parts = eq.split('=');
                return {
                    success: true,
                    type: 'implicit',
                    left: parts[0],
                    right: parts[1],
                    display: formatEquation(parts[0]) + ' = ' + parts[1]
                };
            }
            
            // If just an expression, assume y = expression
            return {
                success: true,
                type: 'explicit',
                f: eq,
                display: `y = ${formatEquation(eq)}`
            };
        }
        
        // Format equation for display
        function formatEquation(eq) {
            return eq
                .replace(/\^2/g, '²')
                .replace(/\^3/g, '³')
                .replace(/sin\(/g, 'sin(')
                .replace(/cos\(/g, 'cos(')
                .replace(/tan\(/g, 'tan(')
                .replace(/ln\(/g, 'ln(')
                .replace(/sqrt\(/g, '√(');
        }
        
        // Calculate orthogonal trajectory
        function calculateTrajectory(parsed) {
            const steps = [];
            let equation = '';
            
            switch(parsed.type) {
                case 'explicit':
                    const f = parsed.f;
                    
                    steps.push(`1. Original curve: y = ${formatEquation(f)}`);
                    
                    // Handle common functions
                    if (f === 'x^2') {
                        steps.push('2. Find derivative: dy/dx = 2x');
                        steps.push('3. Orthogonal condition: dy/dx = -1/(2x)');
                        steps.push('4. Solve differential equation:');
                        steps.push('   ∫dy = ∫-1/(2x) dx');
                        steps.push('   y = -½ ∫(1/x) dx');
                        steps.push('   y = -½ ln|x| + C');
                        equation = 'y = -½ ln|x| + C';
                    }
                    else if (f === '1/x' || f === 'x^(-1)') {
                        steps.push('2. Find derivative: dy/dx = -1/x²');
                        steps.push('3. Orthogonal condition: dy/dx = x²');
                        steps.push('4. Solve: ∫dy = ∫x² dx');
                        steps.push('   y = (1/3)x³ + C');
                        equation = 'y = (1/3)x³ + C';
                    }
                    else if (f === 'sin(x)') {
                        steps.push('2. Find derivative: dy/dx = cos(x)');
                        steps.push('3. Orthogonal condition: dy/dx = -1/cos(x) = -sec(x)');
                        steps.push('4. Solve: ∫dy = ∫-sec(x) dx');
                        steps.push('   y = -ln|sec(x) + tan(x)| + C');
                        equation = 'y = -ln|sec(x) + tan(x)| + C';
                    }
                    else if (f === 'e^x' || f === 'exp(x)') {
                        steps.push('2. Find derivative: dy/dx = e^x');
                        steps.push('3. Orthogonal condition: dy/dx = -e^{-x}');
                        steps.push('4. Solve: ∫dy = ∫-e^{-x} dx');
                        steps.push('   y = e^{-x} + C');
                        equation = 'y = e^{-x} + C';
                    }
                    else if (f === 'x^3') {
                        steps.push('2. Find derivative: dy/dx = 3x²');
                        steps.push('3. Orthogonal condition: dy/dx = -1/(3x²)');
                        steps.push('4. Solve: ∫dy = ∫-1/(3x²) dx');
                        steps.push('   y = 1/(3x) + C');
                        equation = 'y = 1/(3x) + C';
                    }
                    else if (f === 'x') {
                        steps.push('2. Find derivative: dy/dx = 1');
                        steps.push('3. Orthogonal condition: dy/dx = -1');
                        steps.push('4. Solve: ∫dy = ∫-1 dx');
                        steps.push('   y = -x + C');
                        equation = 'y = -x + C';
                    }
                    else if (f === 'sqrt(x)' || f === 'x^(1/2)') {
                        steps.push('2. Find derivative: dy/dx = 1/(2√x)');
                        steps.push('3. Orthogonal condition: dy/dx = -2√x');
                        steps.push('4. Solve: ∫dy = ∫-2√x dx');
                        steps.push('   y = -(4/3)x^(3/2) + C');
                        equation = 'y = -(4/3)x^(3/2) + C';
                    }
                    else {
                        steps.push('2. Find derivative: f\'(x)');
                        steps.push('3. Orthogonal condition: dy/dx = -1/f\'(x)');
                        steps.push('4. Solve the differential equation');
                        equation = 'dy/dx = -1/f\'(x) where f(x) = ' + formatEquation(f);
                    }
                    break;
                    
                case 'circle':
                    const r = parsed.r;
                    steps.push(`1. Original curve: x² + y² = ${r}²`);
                    steps.push('2. Implicit differentiation: 2x + 2y(dy/dx) = 0');
                    steps.push('3. Solve for dy/dx: dy/dx = -x/y');
                    steps.push('4. Orthogonal condition: dy/dx = y/x');
                    steps.push('5. Solve: ∫(1/y) dy = ∫(1/x) dx');
                    steps.push('   ln|y| = ln|x| + C');
                    steps.push('   y = Cx');
                    equation = 'y = Cx (lines through origin)';
                    break;
                    
                default:
                    steps.push('1. Original curve: ' + parsed.display);
                    steps.push('2. Use implicit differentiation');
                    steps.push('3. Apply orthogonal condition: m₁ × m₂ = -1');
                    steps.push('4. Solve resulting differential equation');
                    equation = 'Solve: F_x dx + F_y dy = 0';
            }
            
            return { equation, steps };
        }
        
        // Update chart with data
        function updateChart(parsed, result) {
            initializeChart();
            
            let originalData = [];
            let orthogonalData = [];
            
            // Generate data for original curve
            switch(parsed.type) {
                case 'explicit':
                    originalData = generateExplicitData(parsed.f, -5, 5, 0.1);
                    break;
                case 'circle':
                    originalData = generateCircleData(parsed.r, 100);
                    break;
                default:
                    // Default to parabola for unknown types
                    originalData = generateExplicitData('x^2', -5, 5, 0.1);
            }
            
            // Generate orthogonal trajectories based on result
            if (result.equation.includes('y = Cx')) {
                // Lines through origin for circles
                orthogonalData = generateLinesThroughOrigin(6, 5);
            }
            else if (result.equation.includes('ln|x|')) {
                // Logarithmic curves for parabolas
                orthogonalData = generateLogCurves(5, -3, 3, 0.2);
            }
            else if (result.equation.includes('x³')) {
                // Cubic curves for hyperbolas
                orthogonalData = generateCubicCurves(5, -3, 3, 0.2);
            }
            else if (result.equation.includes('e^{-x}')) {
                // Exponential decay for exponentials
                orthogonalData = generateExpDecayCurves(5, -3, 3, 0.2);
            }
            else {
                // Default orthogonal lines
                orthogonalData = generateDefaultOrthogonals(6, -5, 5);
            }
            
            // Update chart data
            trajectoryChart.data.datasets[0].data = originalData;
            trajectoryChart.data.datasets[1].data = orthogonalData;
            trajectoryChart.update();
        }
        
        // Data generation functions
        
        function generateExplicitData(f, xMin, xMax, step) {
            const data = [];
            for (let x = xMin; x <= xMax; x += step) {
                try {
                    const expr = f
                        .replace(/\^/g, '**')
                        .replace(/sin\(/g, 'Math.sin(')
                        .replace(/cos\(/g, 'Math.cos(')
                        .replace(/tan\(/g, 'Math.tan(')
                        .replace(/sqrt\(/g, 'Math.sqrt(')
                        .replace(/ln\(/g, 'Math.log(')
                        .replace(/e\^/g, 'Math.exp(')
                        .replace(/exp\(/g, 'Math.exp(');
                    
                    const y = eval(expr);
                    if (Math.abs(y) < 20) { // Limit extreme values
                        data.push({x: x, y: y});
                    }
                } catch(e) {
                    // Skip invalid points
                }
            }
            return data;
        }
        
        function generateCircleData(r, points) {
            const data = [];
            for (let i = 0; i <= points; i++) {
                const theta = (i * 2 * Math.PI) / points;
                data.push({
                    x: r * Math.cos(theta),
                    y: r * Math.sin(theta)
                });
            }
            return data;
        }
        
        function generateLinesThroughOrigin(count, length) {
            const data = [];
            for (let i = 0; i < count; i++) {
                const angle = (i * Math.PI) / count;
                for (let t = -length; t <= length; t += 0.5) {
                    data.push({
                        x: t * Math.cos(angle),
                        y: t * Math.sin(angle)
                    });
                }
                data.push({x: NaN, y: NaN}); // Break
            }
            return data;
        }
        
        function generateLogCurves(count, xMin, xMax, step) {
            const data = [];
            for (let c = -count/2; c <= count/2; c++) {
                for (let x = xMin; x <= xMax; x += step) {
                    if (x !== 0) {
                        data.push({
                            x: x,
                            y: -0.5 * Math.log(Math.abs(x)) + c
                        });
                    }
                }
                data.push({x: NaN, y: NaN}); // Break
            }
            return data;
        }
        
        function generateCubicCurves(count, xMin, xMax, step) {
            const data = [];
            for (let c = -count/2; c <= count/2; c++) {
                for (let x = xMin; x <= xMax; x += step) {
                    data.push({
                        x: x,
                        y: (1/3) * Math.pow(x, 3) + c
                    });
                }
                data.push({x: NaN, y: NaN}); // Break
            }
            return data;
        }
        
        function generateExpDecayCurves(count, xMin, xMax, step) {
            const data = [];
            for (let c = -count/2; c <= count/2; c++) {
                for (let x = xMin; x <= xMax; x += step) {
                    data.push({
                        x: x,
                        y: Math.exp(-x) + c
                    });
                }
                data.push({x: NaN, y: NaN}); // Break
            }
            return data;
        }
        
        function generateDefaultOrthogonals(count, xMin, xMax) {
            const data = [];
            for (let i = 0; i < count; i++) {
                const m = -2 + (i * 4) / (count - 1);
                for (let x = xMin; x <= xMax; x += 0.5) {
                    data.push({
                        x: x,
                        y: m * x + (i - count/2) * 2
                    });
                }
                data.push({x: NaN, y: NaN}); // Break
            }
            return data;
        }
        
        // Initialize on page load
        window.addEventListener('DOMContentLoaded', function() {
            initializeChart();
            calculateOrthogonal();
        });
    </script>
</body>
</html>
